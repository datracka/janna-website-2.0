---
const GA_ID = import.meta.env.PUBLIC_GOOGLE_ANALYTICS_ID;
---

{GA_ID && (
  <>
    <!-- Load GA4 library via Partytown -->
    <script type="text/partytown" src={`https://www.googletagmanager.com/gtag/js?id=${GA_ID}`}></script>
    
    <!-- Initialize GA4 in the worker -->
    <script
      type="text/partytown"
      set:html={`
        window.dataLayer = window.dataLayer || [];
        function gtag(){ dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', '${GA_ID}', { anonymize_ip: true });
      `}
    ></script>
  </>
)}
    